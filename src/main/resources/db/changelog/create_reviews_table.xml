<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.6.xsd">

<!-- Create the 'reviews' table -->
<changeSet id="201" author="maha">
    <createTable tableName="reviews">
        <column name="review_id" type="int" autoIncrement="true" startWith="4000" incrementBy="1">
            <constraints primaryKey="true" primaryKeyName="PK_reviews" nullable="false"/>

        </column>
        <column name="book_id" type="int">
            <constraints  nullable="false"/>
        </column>

        <column name="user_id" type="int">
            <constraints  nullable="false"/>
        </column>

        <column name="rating" type="int">
            <constraints checkConstraint="rating &lt;= 10" nullable="false"/>
        </column>
        <column name="comment" type="varchar(100)"/>

        <column name="created_at" type="datetime">
            <constraints nullable="false"/>
        </column>
    </createTable>
</changeSet>

    <changeSet id="202" author="maha">
        <addForeignKeyConstraint baseTableName="reviews" baseColumnNames="book_id" constraintName="fk_book_id" referencedTableName="books"
                                 referencedColumnNames="book_id" onDelete="CASCADE"/>


    </changeSet>

    <changeSet id="203" author="maha">
        <addForeignKeyConstraint baseTableName="reviews" baseColumnNames="user_id" constraintName="fk_user_id" referencedTableName="users"
                                 referencedColumnNames="user_id" onDelete="CASCADE"/>


    </changeSet>

<!-- Insert data into the 'reviews' table -->
<!--<changeSet id="33" author="maha">-->
<!--    <sql>-->
<!--        <![CDATA[-->
<!--                INSERT INTO reviews-->
<!--                VALUES-->
<!--                (2, 8, 10, 'I really enjoyed this book! The characters were so well-developed', '2021-09-09 01:30:00'),-->
<!--                ( 4, 10, 9, 'The plot twists in this book were mind-blowing', '2022-08-18 11:30:00'),-->
<!--                ( 3, 7, 8, 'The imagery in this book is breathtaking. I felt transported to another world', '2023-08-08 05:30:00'),-->
<!--                ( 1, 8, 8, 'A great book for history buffs. The author's research is impressive', '2021-08-06 02:30:00'),-->
<!--               (3, 9, 9, 'I really enjoyed this book! The characters were so well-developed', '2023-02-19 08:30:00'),-->
<!--                ( 2, 9, 8, 'The humor in this book had me laughing out loud in public. Great read', '2022-09-20 07:30:00');-->
<!--            ]]>-->
<!--    </sql>-->
<!--</changeSet>-->
    <changeSet id="204" author="maha">
        <insert tableName="reviews">
            <column name="book_id" value="2001"/>
            <column name="user_id" value="1001"/>
            <column name="rating" value="10"/>
            <column name="comment" value="I really enjoyed this book! The characters were so well-developed"/>
            <column name="created_at" value="2021-09-09 01:30:00"/>
        </insert>

        <insert tableName="reviews">
            <column name="book_id" value="2002"/>
            <column name="user_id" value="1002"/>
            <column name="rating" value="9"/>
            <column name="comment" value="The plot twists in this book were mind-blowing"/>
            <column name="created_at" value="2022-08-18 11:30:00"/>
        </insert>
        <insert tableName="reviews">
            <column name="book_id" value="2003"/>
            <column name="user_id" value="1003"/>
            <column name="rating" value="9"/>
            <column name="comment" value="The imagery in this book is breathtaking. I felt transported to another world"/>
            <column name="created_at" value="2023-08-08 05:30:00"/>

        </insert>
        <insert tableName="reviews">
            <column name="book_id" value="2004"/>
            <column name="user_id" value="1004"/>
            <column name="rating" value="8"/>
            <column name="comment" value="I really enjoyed this book! The characters were so well-developed"/>
            <column name="created_at" value="2023-02-19 08:30:00"/>

        </insert>
        <insert tableName="reviews">
            <column name="book_id" value="2003"/>
            <column name="user_id" value="1002"/>
            <column name="rating" value="9"/>
            <column name="comment" value="The humor in this book had me laughing out loud in public. Great read"/>
            <column name="created_at" value="2022-09-20 07:30:00"/>
        </insert>
    </changeSet>




</databaseChangeLog>
